<?xml version="1.0"?>
<hip:ImageRendererClass
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:js="js.core" xmlns:ui="js.ui" xmlns:hip="hip" xmlns:view="hip.view"
        xmlns:command="hip.command" xmlns:handler="hip.handler" xmlns:svg="hip.svg" xmlns:util="hip.util"
        xmlns:data="hip.data" xmlns:conf="js.conf" xmlns:store="hip.store" xmlns:action="hip.action">

    <js:Injection cid="injection">
        <data:HipDataSource cid="api" gateway="/api/v1" imageRenderSecret="blublablub"/>
        <util:CloudinaryImageUploader apiKey="{ENV().apiKey}" secret="{ENV().secret}"/>
        <util:ImageFileReader/>
        <svg:TextMeasurer/>

        <action:Executor cid="executor"/>

        <action:NavigationActions cid="navigationActions"/>
        <action:ProductActions cid="productActions"/>
        <action:TextFlowActions/>

        <store:NavigationStore cid="navigationStore"/>
        <store:ProductStore cid="productStore"/>
        <store:TextFlowStore cid="textFlowStore"/>

        <view:ImageFilterRenderer/>
        <svg:TextEditor/>
    </js:Injection>

    <js:Router cid="router">
        <conf:RouteConfiguration route="^printout/(\w+)$" onexec="renderPrintout"/>
        <conf:RouteConfiguration route="^product/(\w+)$" onexec="renderProduct"/>
    </js:Router>

    <svg:PrintoutViewer visible="{isPrintout}" height="4000" width="{height2With(height)}"
                       style="display: block; -webkit-transform: translateZ(0);"/>

    <svg:ProductViewer visible="{not(isPrintout)}" width="900" height="900"
                       style="display: block; -webkit-transform: translateZ(0);"/>

</hip:ImageRendererClass>